// Generated by js_of_ocaml
//# buildInfo:effects=false, kind=cma, use-js-string=true, version=5.9.1

//# unitInfo: Provides: Vdom_file_download
//# unitInfo: Requires: Base__Field, Core, Core__Bigstring, Core__List, Css_gen, Expect_test_collector, Js_of_ocaml__Dom_html, Js_of_ocaml__File, Js_of_ocaml__Js, Js_of_ocaml__Typed_array, Ppx_bench_lib__Benchmark_accumulator, Ppx_inline_test_lib, Ppx_module_timer_runtime, Sexplib0__Sexp_conv, Virtual_dom__Effect, Virtual_dom__Node, Virtual_dom__Vdom
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_Vdom_file_download = "Vdom_file_download",
    cst_vdom_file_download = "vdom_file_download";
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) === 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) === 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) === 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    Virtual_dom_Effect = global_data.Virtual_dom__Effect,
    Css_gen = global_data.Css_gen,
    Virtual_dom_Vdom = global_data.Virtual_dom__Vdom,
    Core_List = global_data.Core__List,
    Virtual_dom_Node = global_data.Virtual_dom__Node,
    Ppx_inline_test_lib = global_data.Ppx_inline_test_lib,
    Sexplib0_Sexp_conv = global_data.Sexplib0__Sexp_conv,
    Core = global_data.Core,
    Js_of_ocaml_Dom_html = global_data.Js_of_ocaml__Dom_html,
    Core_Bigstring = global_data.Core__Bigstring,
    Js_of_ocaml_Typed_array = global_data.Js_of_ocaml__Typed_array,
    Js_of_ocaml_File = global_data.Js_of_ocaml__File;
   global_data.Base__Field;
   var
    Ppx_module_timer_runtime = global_data.Ppx_module_timer_runtime,
    Ppx_bench_lib_Benchmark_accumu =
      global_data.Ppx_bench_lib__Benchmark_accumulator,
    Expect_test_collector = global_data.Expect_test_collector;
   caml_call1(Ppx_module_timer_runtime[4], cst_Vdom_file_download);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][1], cst_vdom_file_download);
   caml_call1
    (Expect_test_collector[6][1], "vdom_file_download/vdom_file_download.ml");
   caml_call2
    (Ppx_inline_test_lib[5], cst_vdom_file_download, "vdom_file_download.ml");
   var
    _a_ = [0, [11, "<downloader: ", [2, 0, [12, 62, 0]]], "<downloader: %s>"],
    _b_ = [0, "mimetype"],
    _c_ = [0, "filename"],
    cst_Download_triggered = "Download triggered",
    _d_ = [0, 869834347, "grey"];
   function create(filename, mimetype, contents){return [0, filename, mimetype, contents];
   }
   function sexp_of_t(t){return [0, caml_call2(Core[259], _a_, t[1])];}
   function trigger(param){
    var contents = param[3], mimetype = param[2], filename = param[1];
    if(Ppx_inline_test_lib[1]){
     var
      _l_ = [0, caml_call1(Sexplib0_Sexp_conv[7], contents), 0],
      _m_ = [0, [1, [0, _b_, [0, caml_call1(Core[484], mimetype), 0]]], _l_],
      _n_ = [0, [1, [0, _c_, [0, caml_call1(Core[484], filename), 0]]], _m_],
      _o_ =
        [1,
         [0, caml_call1(Sexplib0_Sexp_conv[7], cst_Download_triggered), _n_]];
     return caml_call2(Core[250], 0, _o_);
    }
    var
     t5 = caml_call1(Js_of_ocaml_Dom_html[67], Js_of_ocaml_Dom_html[2]),
     _p_ = caml_call3(Core_Bigstring[14], 0, 0, contents),
     contents_bigstr = caml_call1(Js_of_ocaml_Typed_array[50][1], _p_),
     blob =
       caml_call3
        (Js_of_ocaml_File[2],
         [0, mimetype],
         0,
         [0, [0, 1037850489, contents_bigstr], 0]),
     t0 = Js_of_ocaml_Dom_html[8],
     t2 = t0.URL,
     url = t2.createObjectURL(blob);
    t5.setAttribute("href", url);
    var t7 = runtime.caml_jsstring_of_string(filename);
    t5.setAttribute("download", t7);
    t5.click();
    var t10 = Js_of_ocaml_Dom_html[8], t12 = t10.URL;
    return t12.revokeObjectURL(url);
   }
   function create$0(_f_, _e_, opt, get_download, button_text, param){
    var
     enabled = _f_ ? _f_[1] : 1,
     on_click = _e_ ? _e_[1] : function(param){return Virtual_dom_Effect[1];},
     extra_attrs = opt ? opt[1] : 0;
    function trigger_csv_download(ev){
     trigger(caml_call1(get_download, 0));
     return caml_call1(on_click, ev);
    }
    if(enabled)
     var enabled_disabled = 0;
    else
     var
      _j_ = caml_call1(Css_gen[49], _d_),
      _k_ = [0, caml_call1(Virtual_dom_Vdom[1][29], _j_), 0],
      enabled_disabled = [0, Virtual_dom_Vdom[1][18], _k_];
    var
     _g_ =
       [0,
        extra_attrs,
        [0,
         enabled_disabled,
         [0,
          [0, caml_call1(Virtual_dom_Vdom[1][55], trigger_csv_download), 0],
          0]]],
     attrs = caml_call1(Core_List[10], _g_),
     _h_ = [0, caml_call1(Virtual_dom_Node[5], button_text), 0],
     _i_ = [0, [0, caml_call1(Virtual_dom_Vdom[1][9], attrs), 0]];
    return caml_call3(Virtual_dom_Node[10], 0, _i_, _h_);
   }
   var Button = [0, create$0];
   caml_call1(Ppx_inline_test_lib[6], cst_vdom_file_download);
   caml_call1(Expect_test_collector[6][2], 0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][2], 0);
   caml_call1(Ppx_module_timer_runtime[5], cst_Vdom_file_download);
   var Vdom_file_download = [0, sexp_of_t, create, trigger, Button];
   runtime.caml_register_global
    (41, Vdom_file_download, cst_Vdom_file_download);
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmRvbV9maWxlX2Rvd25sb2FkLmNtYS5qcyIsInNlY3Rpb25zIjpbeyJvZmZzZXQiOnsibGluZSI6OSwiY29sdW1uIjowfSwibWFwIjp7InZlcnNpb24iOjMsImZpbGUiOiJ2ZG9tX2ZpbGVfZG93bmxvYWQuY21hLmpzIiwibmFtZXMiOlsicnVudGltZSIsImNzdF9WZG9tX2ZpbGVfZG93bmxvYWQiLCJjc3RfdmRvbV9maWxlX2Rvd25sb2FkIiwiY2FtbF9jYWxsMSIsImYiLCJhMCIsImNhbWxfY2FsbDIiLCJhMSIsImNhbWxfY2FsbDMiLCJhMiIsImdsb2JhbF9kYXRhIiwiVmlydHVhbF9kb21fRWZmZWN0IiwiQ3NzX2dlbiIsIlZpcnR1YWxfZG9tX1Zkb20iLCJDb3JlX0xpc3QiLCJWaXJ0dWFsX2RvbV9Ob2RlIiwiUHB4X2lubGluZV90ZXN0X2xpYiIsIlNleHBsaWIwX1NleHBfY29udiIsIkNvcmUiLCJKc19vZl9vY2FtbF9Eb21faHRtbCIsIkNvcmVfQmlnc3RyaW5nIiwiSnNfb2Zfb2NhbWxfVHlwZWRfYXJyYXkiLCJKc19vZl9vY2FtbF9GaWxlIiwiUHB4X21vZHVsZV90aW1lcl9ydW50aW1lIiwiUHB4X2JlbmNoX2xpYl9CZW5jaG1hcmtfYWNjdW11IiwiRXhwZWN0X3Rlc3RfY29sbGVjdG9yIiwiY3N0X0Rvd25sb2FkX3RyaWdnZXJlZCIsImNyZWF0ZSIsImZpbGVuYW1lIiwibWltZXR5cGUiLCJjb250ZW50cyIsInNleHBfb2ZfdCIsInQiLCJ0cmlnZ2VyIiwicGFyYW0iLCJ0NSIsImNvbnRlbnRzX2JpZ3N0ciIsImJsb2IiLCJ0MCIsInQyIiwidXJsIiwidDciLCJ0MTAiLCJ0MTIiLCJvcHQiLCJnZXRfZG93bmxvYWQiLCJidXR0b25fdGV4dCIsImVuYWJsZWQiLCJvbl9jbGljayIsImV4dHJhX2F0dHJzIiwidHJpZ2dlcl9jc3ZfZG93bmxvYWQiLCJldiIsImVuYWJsZWRfZGlzYWJsZWQiLCJhdHRycyIsIkJ1dHRvbiIsIlZkb21fZmlsZV9kb3dubG9hZCJdLCJzb3VyY2VzIjpbIi9idWlsdGluL2JsYWNrYm94Lm1sIiwiL1VzZXJzL3lhbm5pY2svLm9wYW0vYm9uc2FpLWZyb250ZW5kL2xpYi9pbmNyX2RvbS92ZG9tX2ZpbGVfZG93bmxvYWQvdmRvbV9maWxlX2Rvd25sb2FkLm1sIl0sIm1hcHBpbmdzIjoiSUFBQUEsVUFBQTtBQUFBLElBQUFDLHlCQUFBO0FBQUEsSUFBQUMseUJBQUE7QUFBQSxZQUFBQyxXQUFBQyxHQUFBQztBQUFBQSxJQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsWUFBQUMsV0FBQUYsR0FBQUMsSUFBQUU7QUFBQUEsSUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLFlBQUFDLFdBQUFKLEdBQUFDLElBQUFFLElBQUFFO0FBQUFBLElBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFDLGNBQUE7QUFBQSxJQUFBQyxxQkFBQTtBQUFBLElBQUFDLFVBQUE7QUFBQSxJQUFBQyxtQkFBQTtBQUFBLElBQUFDLFlBQUE7QUFBQSxJQUFBQyxtQkFBQTtBQUFBLElBQUFDLHNCQUFBO0FBQUEsSUFBQUMscUJBQUE7QUFBQSxJQUFBQyxPQUFBO0FBQUEsSUFBQUMsdUJBQUE7QUFBQSxJQUFBQyxpQkFBQTtBQUFBLElBQUFDLDBCQUFBO0FBQUEsSUFBQUMsbUJBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUMsMkJBQUE7QUFBQSxJQUFBQztBQUFBQSxNQUFBO0FBQUEsSUFBQUMsd0JBQUE7QUFBQSxHQ0FBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUMseUJBQUE7QUFBQTtBQUFBLFlBQUFDLE9BQUFDLFVBQUFDLFVBQUFDLFVBR0s7QUFBQSxHQUFDO0FBQUEsWUFBQUMsVUFBQUMsR0FRc0IsNENBQXVDO0FBQUEsWUFBQUMsUUFBQUM7QUFBQUEsUUFBQUosV0FFdkQsVUFBQUQsV0FBQSxVQUFBRCxXQUFBO0FBQUEsSUFDVjtBQUFBO0FBQUEsWUFJMkU7QUFBQSxZQUFwQjtBQUFBLFlBQXBCO0FBQUE7QUFBQSxRQUFyQjtBQUFBO0FBQUEsS0FBb0Isb0NBaUJZO0FBQUE7QUFBQTtBQUFBLEtBQUFPLEtBZHBDO0FBQUEsV0FFK0I7QUFBQSxLQUFBQyxrQkFBckM7QUFBQSxLQUFBQztBQUFBQSxPQU1BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFBQyxLQUVGO0FBQUEsS0FBQUMsS0FBVTtBQUFBLEtBQUFDLE1BQUE7QUFBQSxJQUNWO0FBQUEsUUFBQUMsS0FDdUM7QUFBQSxJQUF2QztBQUFBLElBQ0E7QUFBQSxRQUFBQyxNQUFRLHlCQUFBQyxNQUNSO0FBQUEsSUFBc0IsK0JBQXNCO0FBQUE7QUFBQSxZQUFBaEIsU0FBQSxVQUFBaUIsS0FBQUMsY0FBQUMsYUFBQVo7QUFBQUE7QUFBQUEsS0FBQWEsVUFLeEM7QUFBQSxLQUFBQyxXQUFBLHdCQUFBZCxPQUNzQiw2QkFBa0I7QUFBQSxLQUFBZSxjQUR4QztBQUFBLGFBQUFDLHFCQUFBQztBQUFBQSxLQVNGLFFBQVE7QUFBQSxLQUFpQiwrQkFDZDtBQUFBO0FBQUEsSUFFYjtBQUFBLFNBQUFDLG1CQUNrQjtBQUFBO0FBQUE7QUFBQSxZQUFvQztBQUFBLFlBQVg7QUFBQSxNQUFBQSxtQkFBeUM7QUFBQTtBQUFBO0FBQUEsT0FHL0M7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxLQUFBQyxRQUFuQztBQUFBLFdBR3FEO0FBQUEsV0FBbEM7QUFBQSxJQUE2QixvREFBNEI7QUFBQTtBQUFBLE9BQUFDLFNBM0RsRjtBQUFBLEdBNkRHO0FBQUE7QUFBQTtBQUFBO0FBQUEsT0FBQUMscUJBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFRDdESCIsInNvdXJjZXNDb250ZW50IjpbIigqIGdlbmVyYXRlZCBjb2RlICopIiwib3BlbiBDb3JlXG5vcGVuIFZpcnR1YWxfZG9tXG5cbnR5cGUgdCA9XG4gIHsgZmlsZW5hbWUgOiBzdHJpbmdcbiAgOyBtaW1ldHlwZSA6IHN0cmluZ1xuICA7IGNvbnRlbnRzIDogc3RyaW5nXG4gIH1cbltAQGRlcml2aW5nIGZpZWxkc11cblxubGV0IGNyZWF0ZSA9IEZpZWxkcy5jcmVhdGVcbmxldCBzZXhwX29mX3QgdCA9IFNleHAuQXRvbSAoc3ByaW50ZiBcIjxkb3dubG9hZGVyOiAlcz5cIiB0LmZpbGVuYW1lKVxuXG5sZXQgdHJpZ2dlciB7IGZpbGVuYW1lOyBtaW1ldHlwZTsgY29udGVudHMgfSA9XG4gIGxldCBvcGVuIEpzX29mX29jYW1sIGluXG4gIGlmIFBweF9pbmxpbmVfdGVzdF9saWIuYW1fcnVubmluZ1xuICB0aGVuXG4gICAgcHJpbnRfc1xuICAgICAgWyVtZXNzYWdlIFwiRG93bmxvYWQgdHJpZ2dlcmVkXCIgKGZpbGVuYW1lIDogc3RyaW5nKSAobWltZXR5cGUgOiBzdHJpbmcpIGNvbnRlbnRzXVxuICBlbHNlIChcbiAgICAoKiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTkzMjg4OTEvNTU4NTkyICopXG4gICAgbGV0IGEgPSBEb21faHRtbC5jcmVhdGVBIERvbV9odG1sLmRvY3VtZW50IGluXG4gICAgbGV0IGNvbnRlbnRzX2JpZ3N0ciA9XG4gICAgICBUeXBlZF9hcnJheS5CaWdzdHJpbmcudG9fYXJyYXlCdWZmZXIgKEJpZ3N0cmluZy5vZl9zdHJpbmcgY29udGVudHMpXG4gICAgaW5cbiAgICBsZXQgYmxvYiA9XG4gICAgICAoKiBEb24ndCB1c2UgW2Jsb2JfZnJvbV9zdHJpbmddLiBUaGF0IGhhcyBhbiBhdHRyYWN0aXZlIHR5cGUgYnV0IHdvcmtzIGJ5IGZpcnN0XG4gICAgICAgICBjb252ZXJ0aW5nIG91ciBPQ2FtbCBzdHJpbmcgdG8gYSBKYXZhc2NyaXB0IHN0cmluZywgd2hpY2ggY29udmVydHMgdG9cbiAgICAgICAgIFVURi0xNi4gSWYgdGhlIHN0cmluZyBjb250YWlucyByYW5kb20gYmluYXJ5IGRhdGEgdGhhdCB3aWxsIGRpc3RvcnQgaXQuICopXG4gICAgICBGaWxlLmJsb2JfZnJvbV9hbnkgWyBgYXJyYXlCdWZmZXIgY29udGVudHNfYmlnc3RyIF0gfmNvbnRlbnRUeXBlOm1pbWV0eXBlXG4gICAgaW5cbiAgICBsZXQgdXJsID0gRG9tX2h0bWwud2luZG93IyMuX1VSTCMjY3JlYXRlT2JqZWN0VVJMIGJsb2IgaW5cbiAgICBhIyNzZXRBdHRyaWJ1dGUgKEpzLnN0cmluZyBcImhyZWZcIikgdXJsO1xuICAgIGEjI3NldEF0dHJpYnV0ZSAoSnMuc3RyaW5nIFwiZG93bmxvYWRcIikgKEpzLnN0cmluZyBmaWxlbmFtZSk7XG4gICAgYSMjY2xpY2s7XG4gICAgRG9tX2h0bWwud2luZG93IyMuX1VSTCMjcmV2b2tlT2JqZWN0VVJMIHVybClcbjs7XG5cbm1vZHVsZSBCdXR0b24gPSBzdHJ1Y3RcbiAgbGV0IGNyZWF0ZVxuICAgICAgICA/KGVuYWJsZWQgPSB0cnVlKVxuICAgICAgICA/KG9uX2NsaWNrID0gZnVuIF8gLT4gVmRvbS5FZmZlY3QuSWdub3JlKVxuICAgICAgICA/KGV4dHJhX2F0dHJzID0gW10pXG4gICAgICAgIH5nZXRfZG93bmxvYWRcbiAgICAgICAgfmJ1dHRvbl90ZXh0XG4gICAgICAgICgpXG4gICAgPVxuICAgIGxldCBvcGVuIFZkb20gaW5cbiAgICBsZXQgdHJpZ2dlcl9jc3ZfZG93bmxvYWQgZXYgPVxuICAgICAgdHJpZ2dlciAoZ2V0X2Rvd25sb2FkICgpKTtcbiAgICAgIG9uX2NsaWNrIGV2XG4gICAgaW5cbiAgICBsZXQgZW5hYmxlZF9kaXNhYmxlZCA9XG4gICAgICBpZiBlbmFibGVkIHRoZW4gW10gZWxzZSBbIEF0dHIuZGlzYWJsZWQ7IEF0dHIuc3R5bGUgKENzc19nZW4uY29sb3IgKGBOYW1lIFwiZ3JleVwiKSkgXVxuICAgIGluXG4gICAgbGV0IGF0dHJzID1cbiAgICAgIFsgZXh0cmFfYXR0cnM7IGVuYWJsZWRfZGlzYWJsZWQ7IFsgQXR0ci5vbl9jbGljayB0cmlnZ2VyX2Nzdl9kb3dubG9hZCBdIF1cbiAgICAgIHw+IExpc3QuY29uY2F0XG4gICAgaW5cbiAgICBOb2RlLmJ1dHRvbiB+YXR0cnM6WyBBdHRyLm1hbnlfd2l0aG91dF9tZXJnZSBhdHRycyBdIFsgTm9kZS50ZXh0IGJ1dHRvbl90ZXh0IF1cbiAgOztcbmVuZFxuIl0sImlnbm9yZUxpc3QiOlswXX19XX0=
