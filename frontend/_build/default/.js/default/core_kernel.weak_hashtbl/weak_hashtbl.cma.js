// Generated by js_of_ocaml
//# buildInfo:effects=false, kind=cma, use-js-string=true, version=5.9.1

//# unitInfo: Provides: Weak_hashtbl
//# unitInfo: Requires: Base__Error, Base__Exn, Base__Hashable, Base__Hashtbl, Expect_test_collector, Ppx_bench_lib__Benchmark_accumulator, Ppx_inline_test_lib, Ppx_module_timer_runtime, Sexplib0__Sexp_conv, Stdlib, Stdlib__Gc, Thread_safe_queue, Weak_pointer
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    cst_Weak_hashtbl = "Weak_hashtbl",
    cst = "_",
    cst_weak_hashtbl = "weak_hashtbl",
    caml_maybe_attach_backtrace = runtime.caml_maybe_attach_backtrace,
    caml_wrap_exception = runtime.caml_wrap_exception;
   function caml_call1(f, a0){
    return (f.l >= 0 ? f.l : f.l = f.length) === 1
            ? f(a0)
            : runtime.caml_call_gen(f, [a0]);
   }
   function caml_call2(f, a0, a1){
    return (f.l >= 0 ? f.l : f.l = f.length) === 2
            ? f(a0, a1)
            : runtime.caml_call_gen(f, [a0, a1]);
   }
   function caml_call3(f, a0, a1, a2){
    return (f.l >= 0 ? f.l : f.l = f.length) === 3
            ? f(a0, a1, a2)
            : runtime.caml_call_gen(f, [a0, a1, a2]);
   }
   var
    global_data = runtime.caml_get_global_data(),
    Weak_pointer = global_data.Weak_pointer,
    Base_Hashtbl = global_data.Base__Hashtbl,
    Sexplib0_Sexp_conv = global_data.Sexplib0__Sexp_conv,
    Base_Error = global_data.Base__Error,
    Thread_safe_queue = global_data.Thread_safe_queue,
    Base_Exn = global_data.Base__Exn,
    Stdlib_Gc = global_data.Stdlib__Gc,
    Stdlib = global_data.Stdlib,
    Base_Hashable = global_data.Base__Hashable,
    Ppx_module_timer_runtime = global_data.Ppx_module_timer_runtime,
    Ppx_bench_lib_Benchmark_accumu =
      global_data.Ppx_bench_lib__Benchmark_accumulator,
    Expect_test_collector = global_data.Expect_test_collector,
    Ppx_inline_test_lib = global_data.Ppx_inline_test_lib;
   caml_call1(Ppx_module_timer_runtime[4], cst_Weak_hashtbl);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][1], cst_weak_hashtbl);
   caml_call1(Expect_test_collector[6][1], "weak_hashtbl/src/weak_hashtbl.ml");
   caml_call2(Ppx_inline_test_lib[5], cst_weak_hashtbl, "weak_hashtbl.ml");
   var
    _a_ = [0, "thread_safe_run_when_unused_data"],
    _b_ = [0, "keys_with_unused_data"],
    _c_ = [0, "entry_by_key"];
   function sexp_of_t(of_a_001, of_b_002, param){
    var
     keys_with_unused_data_006 = param[2],
     entry_by_key_004 = param[1],
     arg_009 = caml_call1(Sexplib0_Sexp_conv[24], function(_q_){return 0;}),
     bnds_003 = [0, [1, [0, _a_, [0, arg_009, 0]]], 0],
     arg_007 =
       caml_call2(Thread_safe_queue[1], of_a_001, keys_with_unused_data_006),
     bnds_003$0 = [0, [1, [0, _b_, [0, arg_007, 0]]], bnds_003],
     _p_ = caml_call1(Weak_pointer[1], of_b_002),
     arg_005 = caml_call3(Base_Hashtbl[3], of_a_001, _p_, entry_by_key_004),
     bnds_003$1 = [0, [1, [0, _c_, [0, arg_005, 0]]], bnds_003$0];
    return [1, bnds_003$1];
   }
   function create(growth_allowed, size, hashable){
    var
     _m_ = caml_call1(Thread_safe_queue[3], 0),
     _n_ = caml_call1(Base_Hashable[4], hashable);
    return [0,
            caml_call3(Base_Hashtbl[4], growth_allowed, size, _n_),
            _m_,
            function(_o_){return 0;}];
   }
   var
    Using_hashable = [0, create],
    cst_weak_hashtbl_src_weak_hash = "weak_hashtbl/src/weak_hashtbl.ml:79:71",
    _d_ = [0, cst],
    _e_ = [0, cst],
    cst_Weak_hashtbl_add_exn_of_ke = "Weak_hashtbl.add_exn of key in use";
   function create$0(growth_allowed, size, m){
    var _l_ = caml_call1(Base_Hashable[3], m);
    return caml_call3(Using_hashable[1], growth_allowed, size, _l_);
   }
   function set_run_when_unused_data(t, thread_safe_f){t[3] = thread_safe_f; return 0;
   }
   function remove(t, key){return caml_call2(Base_Hashtbl[31], t[1], key);}
   function reclaim_space_for_keys_with_un(t){
    for(;;){
     if(0 >= caml_call1(Thread_safe_queue[4], t[2])) return 0;
     var
      key = caml_call1(Thread_safe_queue[6], t[2]),
      match = caml_call2(Base_Hashtbl[55], t[1], key);
     if(match){
      var entry = match[1];
      if(caml_call1(Weak_pointer[5], entry)) remove(t, key);
     }
    }
   }
   function get_entry(t, key){
    return caml_call3
            (Base_Hashtbl[53],
             t[1],
             key,
             function(param){return caml_call1(Weak_pointer[2], 0);});
   }
   function mem(t, key){
    var match = caml_call2(Base_Hashtbl[55], t[1], key);
    if(! match) return 0;
    var entry = match[1];
    return caml_call1(Weak_pointer[4], entry);
   }
   function key_is_using_space(t, key){
    return caml_call2(Base_Hashtbl[30], t[1], key);
   }
   function set_data(t, key, entry, data){
    caml_call2(Weak_pointer[6], entry, data);
    function cleanup(param){
     return caml_call1
             (Base_Exn[15],
              function(param){
               caml_call2(Thread_safe_queue[5], t[2], key);
               return caml_call1(t[3], 0);
              });
    }
    try{var _j_ = caml_call2(Stdlib_Gc[4], cleanup, data); return _j_;}
    catch(_k_){
     var _i_ = caml_wrap_exception(_k_);
     if(_i_[1] === Stdlib[6]) return 0;
     throw caml_maybe_attach_backtrace(_i_, 0);
    }
   }
   function replace(t, key, data){
    return set_data(t, key, get_entry(t, key), data);
   }
   function add_exn(x_010, key, data){
    var entry = get_entry(x_010, key);
    if(caml_call1(Weak_pointer[4], entry)){
     var
      _f_ =
        [0,
         caml_call1(Sexplib0_Sexp_conv[7], cst_weak_hashtbl_src_weak_hash),
         0],
      _g_ =
        [0,
         sexp_of_t
          (function(param){return _e_;}, function(param){return _d_;}, x_010),
         _f_],
      _h_ =
        [1,
         [0,
          caml_call1(Sexplib0_Sexp_conv[7], cst_Weak_hashtbl_add_exn_of_ke),
          _g_]];
     caml_call1(Base_Error[30], _h_);
    }
    return set_data(x_010, key, entry, data);
   }
   function find(t, key){
    var match = caml_call2(Base_Hashtbl[55], t[1], key);
    if(! match) return 0;
    var entry = match[1];
    return caml_call1(Weak_pointer[3], entry);
   }
   function find_or_add(t, key, default$0){
    var entry = get_entry(t, key), match = caml_call1(Weak_pointer[3], entry);
    if(match){var v = match[1]; return v;}
    var data = caml_call1(default$0, 0);
    set_data(t, key, entry, data);
    return data;
   }
   caml_call1(Ppx_inline_test_lib[6], cst_weak_hashtbl);
   caml_call1(Expect_test_collector[6][2], 0);
   caml_call1(Ppx_bench_lib_Benchmark_accumu[1][2], 0);
   caml_call1(Ppx_module_timer_runtime[5], cst_Weak_hashtbl);
   var
    Weak_hashtbl =
      [0,
       sexp_of_t,
       create$0,
       Using_hashable,
       mem,
       find,
       find_or_add,
       remove,
       add_exn,
       replace,
       key_is_using_space,
       reclaim_space_for_keys_with_un,
       set_run_when_unused_data];
   runtime.caml_register_global(27, Weak_hashtbl, cst_Weak_hashtbl);
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2Vha19oYXNodGJsLmNtYS5qcyIsInNlY3Rpb25zIjpbeyJvZmZzZXQiOnsibGluZSI6OSwiY29sdW1uIjowfSwibWFwIjp7InZlcnNpb24iOjMsImZpbGUiOiJ3ZWFrX2hhc2h0YmwuY21hLmpzIiwibmFtZXMiOlsicnVudGltZSIsImNzdF9XZWFrX2hhc2h0YmwiLCJjc3QiLCJjc3Rfd2Vha19oYXNodGJsIiwiY2FtbF9tYXliZV9hdHRhY2hfYmFja3RyYWNlIiwiY2FtbF93cmFwX2V4Y2VwdGlvbiIsImNhbWxfY2FsbDEiLCJmIiwiYTAiLCJjYW1sX2NhbGwyIiwiYTEiLCJjYW1sX2NhbGwzIiwiYTIiLCJnbG9iYWxfZGF0YSIsIldlYWtfcG9pbnRlciIsIkJhc2VfSGFzaHRibCIsIlNleHBsaWIwX1NleHBfY29udiIsIkJhc2VfRXJyb3IiLCJUaHJlYWRfc2FmZV9xdWV1ZSIsIkJhc2VfRXhuIiwiU3RkbGliX0djIiwiU3RkbGliIiwiQmFzZV9IYXNoYWJsZSIsIlBweF9tb2R1bGVfdGltZXJfcnVudGltZSIsIlBweF9iZW5jaF9saWJfQmVuY2htYXJrX2FjY3VtdSIsIkV4cGVjdF90ZXN0X2NvbGxlY3RvciIsIlBweF9pbmxpbmVfdGVzdF9saWIiLCJzZXhwX29mX3QiLCJvZl9hXzAwMSIsIm9mX2JfMDAyIiwicGFyYW0iLCJrZXlzX3dpdGhfdW51c2VkX2RhdGFfMDA2IiwiZW50cnlfYnlfa2V5XzAwNCIsImFyZ18wMDkiLCJibmRzXzAwMyIsImFyZ18wMDciLCJhcmdfMDA1IiwiY3JlYXRlIiwiZ3Jvd3RoX2FsbG93ZWQiLCJzaXplIiwiaGFzaGFibGUiLCJVc2luZ19oYXNoYWJsZSIsImNzdF93ZWFrX2hhc2h0Ymxfc3JjX3dlYWtfaGFzaCIsImNzdF9XZWFrX2hhc2h0YmxfYWRkX2V4bl9vZl9rZSIsIm0iLCJzZXRfcnVuX3doZW5fdW51c2VkX2RhdGEiLCJ0IiwidGhyZWFkX3NhZmVfZiIsInJlbW92ZSIsImtleSIsInJlY2xhaW1fc3BhY2VfZm9yX2tleXNfd2l0aF91biIsIm1hdGNoIiwiZW50cnkiLCJnZXRfZW50cnkiLCJtZW0iLCJrZXlfaXNfdXNpbmdfc3BhY2UiLCJzZXRfZGF0YSIsImRhdGEiLCJjbGVhbnVwIiwicmVwbGFjZSIsImFkZF9leG4iLCJ4XzAxMCIsImZpbmQiLCJmaW5kX29yX2FkZCIsImRlZmF1bHQiLCJ2IiwiV2Vha19oYXNodGJsIl0sInNvdXJjZXMiOlsiL2J1aWx0aW4vYmxhY2tib3gubWwiLCIvVXNlcnMveWFubmljay8ub3BhbS9ib25zYWktZnJvbnRlbmQvbGliL2NvcmVfa2VybmVsL3dlYWtfaGFzaHRibC93ZWFrX2hhc2h0YmwubWwiXSwibWFwcGluZ3MiOiJJQUFBQSxVQUFBO0FBQUEsSUFBQUMsbUJBQUE7QUFBQSxJQUFBQyxNQUFBO0FBQUEsSUFBQUMsbUJBQUE7QUFBQSxJQUFBQyw4QkFBQTtBQUFBLElBQUFDLHNCQUFBO0FBQUEsWUFBQUMsV0FBQUMsR0FBQUM7QUFBQUEsSUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLFlBQUFDLFdBQUFGLEdBQUFDLElBQUFFO0FBQUFBLElBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxZQUFBQyxXQUFBSixHQUFBQyxJQUFBRSxJQUFBRTtBQUFBQSxJQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQyxjQUFBO0FBQUEsSUFBQUMsZUFBQTtBQUFBLElBQUFDLGVBQUE7QUFBQSxJQUFBQyxxQkFBQTtBQUFBLElBQUFDLGFBQUE7QUFBQSxJQUFBQyxvQkFBQTtBQUFBLElBQUFDLFdBQUE7QUFBQSxJQUFBQyxZQUFBO0FBQUEsSUFBQUMsU0FBQTtBQUFBLElBQUFDLGdCQUFBO0FBQUEsSUFBQUMsMkJBQUE7QUFBQSxJQUFBQztBQUFBQSxNQUFBO0FBQUEsSUFBQUMsd0JBQUE7QUFBQSxJQUFBQyxzQkFBQTtBQUFBLEdDQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLFlBQUFDLFVBQUFDLFVBQUFDLFVBQUFDO0FBQUFBO0FBQUFBLEtBQUFDLDRCQUdBO0FBQUEsS0FBQUMsbUJBQUE7QUFBQSxLQUFBQyxVQUcrQyxpREROL0M7QUFBQSxLQUFBQyxXQ01ZO0FBQUEsS0FBQUM7QUFBQUEsT0FEUjtBQUFBLEtBQUFELGFBQUE7QUFBQSxXQUQyQztBQUFBLEtBQUFFLFVBQTNDO0FBQUEsS0FBQUYsYUFBQTtBQUFBLElBREo7QUFBQSxHQUtvQjtBQUFBLFlBQUFHLE9BQUFDLGdCQUFBQyxNQUFBQztBQUFBQTtBQUFBQSxLQUFBLE1BUXFCO0FBQUEsV0FGL0I7QUFBQSxJQURGO0FBQUE7QUFBQTtBQUFBLDBCRGJSLFdDY3lDO0FBQUEsR0FJcEM7QUFBQTtBQUFBLElBQUFDLGlCQWxCTDtBQUFBLElBQUFDLGlDQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFDLGlDQUFBO0FBQUEsWUFBQU4sU0FBQUMsZ0JBQUFDLE1BQUFLO0FBQUFBLFFBQUEsTUF1QjhDO0FBQUEsSUFBbUI7QUFBQTtBQUFBLFlBQUFDLHlCQUFBQyxHQUFBQyxlQUkvRDtBQUFBLEdBQW1EO0FBQUEsWUFBQUMsT0FBQUYsR0FBQUcsS0FHbEMsOENBQWlDO0FBQUEsWUFBQUMsK0JBQUFKO0FBQUFBLElBTWxEO0FBQUEsS0FBTSxnREFBZ0Q7QUFBQTtBQUFBLE1BQUFHLE1BQzFDO0FBQUEsTUFBQUUsUUFDSjtBQUFBLEtBQStCO0FBQUEsVUFBQUMsUUFBQTtBQUFBLE1BRWxCLHVDQUFnQztBQUFBO0FBQUE7QUFBQSxHQUNqRDtBQUFBLFlBQUFDLFVBQUFQLEdBQUFHO0FBQUFBLElBSUo7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBQW5CLE9BQ3NCLHFDQUFzQixHQUFDO0FBQUE7QUFBQSxZQUFBd0IsSUFBQVIsR0FBQUc7QUFBQUEsUUFBQUUsUUFJdkM7QUFBQSxJQUErQixZQUMzQjtBQUFBLFFBQUFDLFFBRDJCO0FBQUEsSUFFckIseUNBQTBCO0FBQUE7QUFBQSxZQUFBRyxtQkFBQVQsR0FBQUc7QUFBQUEsSUFHYiw4Q0FBOEI7QUFBQTtBQUFBLFlBQUFPLFNBQUFWLEdBQUFHLEtBQUFHLE9BQUFLO0FBQUFBLElBRzNEO0FBQUEsYUFBQUMsUUFBQTVCO0FBQUFBLEtBRUU7QUFBQTtBQUFBLHVCQUFBQTtBQUFBQSxlQUNFO0FBQUEsZUFBcUQsMEJBQ2hCO0FBQUEsZ0JBQUM7QUFBQTtBQUFBLElBRTFDLGNBQUk7QUFBQTtBQUFBLGVEaEVOO0FBQUEsOEJDbUUwQjtBQUFBLEtEbkUxQjtBQUFBO0FBQUEsR0NtRTRCO0FBQUEsWUFBQTZCLFFBQUFiLEdBQUFHLEtBQUFRO0FBQUFBLElBSWMsT0FBaUIsaUJBQWpCLHdCQUFzQjtBQUFBO0FBQUEsWUFBQUcsUUFBQUMsT0FBQVosS0FBQVE7QUFBQUEsUUFBQUwsUUFHbEQ7QUFBQSxJQUNUO0FBQUE7QUFBQTtBQUFBLFFBR2tFO0FBQUE7QUFBQTtBQUFBO0FBQUEsUUFBVjtBQUFBO0FBQUEsb0JBQUF0QixPQUFDLFdBQUMsWUFBQUEsT0FBRSxXQUFDO0FBQUE7QUFBQTtBQUFBLFFBQWxEO0FBQUE7QUFBQTtBQUFBO0FBQUEsS0FEWjtBQUFBO0FBQUEsSUFFRix3Q0FBMEI7QUFBQTtBQUFBLFlBQUFnQyxLQUFBaEIsR0FBQUc7QUFBQUEsUUFBQUUsUUFJcEI7QUFBQSxJQUErQixZQUMzQjtBQUFBLFFBQUFDLFFBRDJCO0FBQUEsSUFFckIseUNBQXNCO0FBQUE7QUFBQSxZQUFBVyxZQUFBakIsR0FBQUcsS0FBQWU7QUFBQUEsUUFBQVosUUFJMUIsbUJBQUFELFFBQ047QUFBQSxJQUFzQixjQUFBYyxJQUFBLFVBQ2hCO0FBQUEsUUFBQVIsT0FFQztBQUFBLElBQ1g7QUFBQSxJQUF5QjtBQUFBLEdBQ3JCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFTO0FBQUFBLE1BQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUQvRlIiLCJzb3VyY2VzQ29udGVudCI6WyIoKiBnZW5lcmF0ZWQgY29kZSAqKSIsIm9wZW4hIEJhc2VcblxuXG50eXBlICgnYSwgJ2IpIHQgPVxuICB7IGVudHJ5X2J5X2tleSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoJ2EsICdiIFdlYWtfcG9pbnRlci50KSBIYXNodGJsLnRcbiAgOyBrZXlzX3dpdGhfdW51c2VkX2RhdGEgICAgICAgICAgICAgICAgICAgIDogJ2EgVGhyZWFkX3NhZmVfcXVldWUudFxuICA7IG11dGFibGUgdGhyZWFkX3NhZmVfcnVuX3doZW5fdW51c2VkX2RhdGEgOiB1bml0IC0+IHVuaXRcbiAgfVxuW0BAZGVyaXZpbmcgc2V4cF9vZl1cblxubW9kdWxlIFVzaW5nX2hhc2hhYmxlID0gc3RydWN0XG4gIGxldCBjcmVhdGUgP2dyb3d0aF9hbGxvd2VkID9zaXplIGhhc2hhYmxlID1cbiAgICB7IGVudHJ5X2J5X2tleSAgICAgICAgICAgICAgICAgICAgID1cbiAgICAgICAgSGFzaHRibC5jcmVhdGUgP2dyb3d0aF9hbGxvd2VkID9zaXplXG4gICAgICAgICAgKEJhc2UuSGFzaGFibGUudG9fa2V5IGhhc2hhYmxlKVxuXG4gICAgOyBrZXlzX3dpdGhfdW51c2VkX2RhdGEgICAgICAgICAgICA9IFRocmVhZF9zYWZlX3F1ZXVlLmNyZWF0ZSAoKVxuICAgIDsgdGhyZWFkX3NhZmVfcnVuX3doZW5fdW51c2VkX2RhdGEgPSBpZ25vcmVcbiAgICB9XG4gIDs7XG5lbmRcblxubGV0IGNyZWF0ZSA/Z3Jvd3RoX2FsbG93ZWQgP3NpemUgbSA9XG4gIFVzaW5nX2hhc2hhYmxlLmNyZWF0ZSA/Z3Jvd3RoX2FsbG93ZWQgP3NpemUgKEhhc2hhYmxlLm9mX2tleSBtKVxuOztcblxubGV0IHNldF9ydW5fd2hlbl91bnVzZWRfZGF0YSB0IH50aHJlYWRfc2FmZV9mID1cbiAgdC50aHJlYWRfc2FmZV9ydW5fd2hlbl91bnVzZWRfZGF0YSA8LSB0aHJlYWRfc2FmZV9mO1xuOztcblxubGV0IHJlbW92ZSB0IGtleSA9IEhhc2h0YmwucmVtb3ZlIHQuZW50cnlfYnlfa2V5IGtleVxuXG4oKiBJbiBvcmRlciBmb3IgYSBjYWxsIHRvIFtyZWNsYWltX3NwYWNlX2Zvcl9rZXlzX3dpdGhfdW51c2VkX2RhdGFdIHRvIHJlY2xhaW0gYSBrZXkgdGhhdFxuICAgd2FzIHByZXZpb3VzbHkgZmluYWxpemVkLCB0aGUgd2VhayBwb2ludGVyIG11c3QgaGF2ZSBiZWVuIGNsZWFyZWQuICBUaGlzIHJlbGllcyBvbiB0aGVcbiAgIGZhY3QgdGhhdCB0aGUgT0NhbWwgZ2FyYmFnZSBjb2xsZWN0b3IgY2xlYXJzIHdlYWtzIGFuZCB0aGVuIHJ1bnMgZmluYWxpemVycy4gKilcbmxldCByZWNsYWltX3NwYWNlX2Zvcl9rZXlzX3dpdGhfdW51c2VkX2RhdGEgdCA9XG4gIHdoaWxlIFRocmVhZF9zYWZlX3F1ZXVlLmxlbmd0aCB0LmtleXNfd2l0aF91bnVzZWRfZGF0YSA+IDAgZG9cbiAgICBsZXQga2V5ID0gVGhyZWFkX3NhZmVfcXVldWUuZGVxdWV1ZV9leG4gdC5rZXlzX3dpdGhfdW51c2VkX2RhdGEgaW5cbiAgICBtYXRjaCBIYXNodGJsLmZpbmQgdC5lbnRyeV9ieV9rZXkga2V5IHdpdGhcbiAgICB8IE5vbmUgLT4gKClcbiAgICB8IFNvbWUgZW50cnkgLT4gaWYgV2Vha19wb2ludGVyLmlzX25vbmUgZW50cnkgdGhlbiByZW1vdmUgdCBrZXlcbiAgZG9uZTtcbjs7XG5cbmxldCBnZXRfZW50cnkgdCBrZXkgPVxuICBIYXNodGJsLmZpbmRfb3JfYWRkIHQuZW50cnlfYnlfa2V5IGtleVxuICAgIH5kZWZhdWx0OihmdW4gKCkgLT4gV2Vha19wb2ludGVyLmNyZWF0ZSAoKSk7XG47O1xuXG5sZXQgbWVtIHQga2V5ID1cbiAgbWF0Y2ggSGFzaHRibC5maW5kIHQuZW50cnlfYnlfa2V5IGtleSB3aXRoXG4gIHwgTm9uZSAtPiBmYWxzZVxuICB8IFNvbWUgZW50cnkgLT4gV2Vha19wb2ludGVyLmlzX3NvbWUgZW50cnlcbjs7XG5cbmxldCBrZXlfaXNfdXNpbmdfc3BhY2UgdCBrZXkgPSBIYXNodGJsLm1lbSB0LmVudHJ5X2J5X2tleSBrZXlcblxubGV0IHNldF9kYXRhIHQga2V5IGVudHJ5IChkYXRhIDogXyBIZWFwX2Jsb2NrLnQpID1cbiAgV2Vha19wb2ludGVyLnNldCBlbnRyeSBkYXRhO1xuICBsZXQgY2xlYW51cCAoKSA9XG4gICAgRXhuLmhhbmRsZV91bmNhdWdodF9hbmRfZXhpdCAoZnVuICgpIC0+XG4gICAgICBUaHJlYWRfc2FmZV9xdWV1ZS5lbnF1ZXVlIHQua2V5c193aXRoX3VudXNlZF9kYXRhIGtleTtcbiAgICAgIHQudGhyZWFkX3NhZmVfcnVuX3doZW5fdW51c2VkX2RhdGEgKCkpXG4gIGluXG4gIHRyeSBTdGRsaWIuR2MuZmluYWxpc2VfbGFzdCBjbGVhbnVwIGRhdGEgd2l0aFxuICAoKiBJbiB0aGlzIGNhc2UsIFt4XSBpcyBrbm93biB0byBiZSBzdGF0aWMgZGF0YSwgd2hpY2ggd2lsbFxuICAgICBuZXZlciBiZSBjb2xsZWN0ZWQgYnkgdGhlIEdDIGFueXdheSwgc28gaXQncyBzYWZlIHRvIGRyb3AgKilcbiAgfCBJbnZhbGlkX2FyZ3VtZW50IF8gLT4gKClcblxuOztcblxubGV0IHJlcGxhY2UgdCB+a2V5IH5kYXRhID0gc2V0X2RhdGEgdCBrZXkgKGdldF9lbnRyeSB0IGtleSkgZGF0YVxuXG5sZXQgYWRkX2V4biB0IH5rZXkgfmRhdGEgPVxuICBsZXQgZW50cnkgPSBnZXRfZW50cnkgdCBrZXkgaW5cbiAgaWYgV2Vha19wb2ludGVyLmlzX3NvbWUgZW50cnlcbiAgdGhlblxuICAgIEVycm9yLnJhaXNlX3NcbiAgICAgIFslbWVzc2FnZSBcIldlYWtfaGFzaHRibC5hZGRfZXhuIG9mIGtleSBpbiB1c2VcIiB+XzoodCA6IChfLCBfKSB0KSBbJWhlcmVdXTtcbiAgc2V0X2RhdGEgdCBrZXkgZW50cnkgZGF0YTtcbjs7XG5cbmxldCBmaW5kIHQga2V5ID1cbiAgbWF0Y2ggSGFzaHRibC5maW5kIHQuZW50cnlfYnlfa2V5IGtleSB3aXRoXG4gIHwgTm9uZSAtPiBOb25lXG4gIHwgU29tZSBlbnRyeSAtPiBXZWFrX3BvaW50ZXIuZ2V0IGVudHJ5XG47O1xuXG5sZXQgZmluZF9vcl9hZGQgdCBrZXkgfmRlZmF1bHQgPVxuICBsZXQgZW50cnkgPSBnZXRfZW50cnkgdCBrZXkgaW5cbiAgbWF0Y2ggV2Vha19wb2ludGVyLmdldCBlbnRyeSB3aXRoXG4gIHwgU29tZSB2IC0+IHZcbiAgfCBOb25lIC0+XG4gICAgbGV0IGRhdGEgPSBkZWZhdWx0ICgpIGluXG4gICAgc2V0X2RhdGEgdCBrZXkgZW50cnkgZGF0YTtcbiAgICBkYXRhXG47O1xuIl0sImlnbm9yZUxpc3QiOlswXX19XX0=
